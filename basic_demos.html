<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kinesis.js Demo</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .demo-section {
        margin-bottom: 40px;
      }

      .container {
        position: relative;
        width: 300px;
        height: 300px;
        border: 1px solid #ccc;
        margin: 0 auto;
      }

      .depth-element {
        width: 100px;
        height: 100px;
        background-color: rgba(255, 99, 71, 0.6);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      .transform-element,
      .audio-element {
        width: 100px;
        height: 100px;
        background-color: rgba(0, 128, 255, 0.6);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      .nested-transform-element {
        width: 100px;
        height: 100px;
        background-color: rgba(0, 128, 255, 0.6);
      }

      h3 {
        text-align: center;
        margin-bottom: 10px;
      }

      .scroll-item-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      .path-container {
        position: relative;
        width: 100%;
        height: 600px;
        margin: 100px auto;
        border: 1px solid #ccc;
        overflow: visible;
      }

      .path-element {
        width: 50px;
        height: 50px;
        background-color: coral;
        border-radius: 50%;
        position: absolute;
        top: 0;
        left: 0;
      }

      /* Optional: Visualize the path */
      .path-visualization {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }

      .path-visualization svg {
        width: 100%;
        height: 100%;
      }

      /* Audio Elements */
      .container[data-kinesisaudio] {
        width: 600px;
        height: 400px;
        margin: 0 auto 20px;
        position: relative;
        background-color: #d0d0d0;
        border: 1px solid #ccc;
        transform-style: preserve-3d;
        transition: transform 1s cubic-bezier(0.23, 1, 0.32, 1);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .container[data-kinesisaudio] div[data-audioelement] {
        position: absolute;
        width: 100px;
        height: 100px;
        background-color: coral;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) translateZ(0);
        transform-origin: center;
        transform-style: preserve-3d;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.1s ease-out;
      }

      .container[data-kinesisaudio] div[data-audioelement]:nth-child(1) {
        background-color: coral;
      }

      .container[data-kinesisaudio] div[data-audioelement]:nth-child(2) {
        background-color: lightblue;
      }

      .container[data-kinesisaudio] div[data-audioelement]:nth-child(3) {
        background-color: lightgreen;
      }

      .container[data-kinesisaudio] div[data-audioelement].large {
        width: 150px;
        height: 150px;
      }

      /* Play and Stop Buttons */
      .container[data-kinesisaudio] button {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 20px;
        margin: 5px;
        background-color: #555;
        color: #fff;
        border: none;
        cursor: pointer;
        border-radius: 5px;
      }

      .container[data-kinesisaudio] button:hover {
        background-color: #777;
      }

      .distance-grid {
        display: grid;
        grid-template-columns: repeat(10, 50px);
        grid-template-rows: repeat(10, 50px);
        gap: 10px;
        justify-content: center;
        align-items: center;
        padding: 50px;
        background-color: #f0f0f0;
        min-height: 300vh;
      }

      /* Individual grid items */
      .distance-item {
        width: 50px;
        height: 50px;
        background-color: #3498db;
        border-radius: 30%; /* Makes them circles */
        transition: transform 0.2s ease-out;
        cursor: pointer;
      }

      /* Optional: Hover effect to indicate interactivity */
      .distance-item:hover {
      }

      /* Responsive adjustments */
      @media (max-width: 600px) {
        .distance-grid {
          grid-template-columns: repeat(10, -100px);
          grid-template-rows: repeat(10, -100px);
          gap: 5px;
          padding: 20px;
        }

        .distance-item {
          width: -100px;
          height: -100px;
        }
      }

      .tilt-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        height: 400px;
      }

      .tilt-container div {
        height: 200px;
        width: 200px;
        background-color: #3498db;
      }

      /* Style for the SVG Grid Container */
      #svg-grid-container {
        width: 100%;
        height: 100vh; /* Full viewport height */
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #f0f0f0; /* Light background for contrast */
      }

      /* Style for the SVG Element */
      .distance-grid-svg {
        border: 1px solid #ccc; /* Optional: Border around the SVG */
        background-color: #fff; /* White background for the SVG */
      }

      /* Style for Nodes */
      .distance-item {
        fill: #3498db; /* Blue color for nodes */
        cursor: pointer; /* Change cursor on hover */
        transition: fill 0.3s ease;
      }

      .distance-item:hover {
        fill: #2980b9; /* Darker blue on hover */
      }

      /* Style for Connecting Lines */
      .distance-line {
        stroke: #95a5a6; /* Grey color for lines */
        stroke-width: 2;
        pointer-events: none; /* Make lines non-interactive */
      }
    </style>
  </head>
  <body>
    <div class="demo-section">
      <h3>Simple Depth Effect</h3>
      <div class="container" data-kinesisdepth data-ks-sensitivity="30">
        <div
          class="depth-element"
          data-kinesisdepth-element
          data-ks-depth="-20"
        ></div>
        <div
          class="depth-element"
          data-kinesisdepth-element
          data-ks-depth="-40"
        ></div>
        <div
          class="depth-element"
          data-kinesisdepth-element
          data-ks-depth="-60"
        ></div>
      </div>
    </div>

    <div class="demo-section">
      <h3>Translate on Scroll on X and Y Axes</h3>
      <div
        class="container"
        data-kinesistransformer
        data-ks-interaction="scroll"
      >
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="30"
          data-ks-transform="rotate"
          data-ks-transformAxis="Z"
        ></div>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="-60"
          data-ks-transform="rotate"
          data-ks-transformAxis="Z"
        ></div>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="90"
          data-ks-transform="rotate"
          data-ks-transformAxis="Z"
        ></div>
      </div>
    </div>

    <section class="demo-section">
      <h3>Standalone scroll item</h3>
      <div class="scroll-item-container container">
        <div
          class="scroll-item"
          data-kinesisscroll-item
          data-ks-transform="scale"
          data-ks-axis="X, Y"
          data-ks-strength="100"
          style="background-color: lightgreen; width: 50px; height: 50px"
        ></div>
      </div>
    </section>

    <div class="demo-section">
      <h3>Translate on X and Y Axes</h3>
      <div class="container" data-kinesistransformer>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="10"
          data-ks-transformAxis="X"
        ></div>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="-20"
        ></div>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="30"
        ></div>
      </div>
    </div>

    <div class="demo-section">
      <h3>Translate on X and Y Axes</h3>
      <div class="container" data-kinesistransformer>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="40"
        ></div>
        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="10"
          data-ks-transformAxis="X"
        ></div>

        <div
          class="transform-element"
          data-kinesistransformer-element
          data-ks-strength="20"
          data-ks-transformAxis="Y"
        ></div>
      </div>
    </div>

    <div class="demo-section">
      <h3>Translate on X and Y Axes</h3>
      <div class="container" data-kinesistransformer>
        <div
          data-kinesistransformer-element
          data-ks-transform="translate"
          data-ks-strength="40"
          class="transform-element"
          data-ks-constraintAxis="X"
        >
          <div
            class="nested-transform-element"
            data-kinesistransformer-element
            data-ks-strength="40"
            data-ks-transform="rotate"
            data-ks-constraintAxis="X"
          ></div>
        </div>
      </div>
    </div>

    <section class="demo-section">
      <div
        class="path-container"
        data-kinesispath
        data-ks-path="M 100,300 C 200,100 400,500 500,300"
        data-ks-duration="300"
        data-ks-interaction="scroll"
      >
        <!-- Visualize the path using SVG -->
        <div class="path-visualization">
          <svg>
            <path
              d="M 100,300 C 200,100 400,500 500,300"
              stroke="#ddd"
              fill="none"
              stroke-width="2"
            />
          </svg>
        </div>

        <!-- Path Elements -->
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="1"
          data-ks-offset="0"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.9"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.8"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.7"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.6"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.5"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.4"
          style="background-color: lightblue"
        ></div>
      </div>

      <div
        class="path-container"
        data-kinesispath
        data-ks-duration="300"
        data-ks-path="M 100,300 C 200,100 400,500 500,300"
      >
        <!-- Visualize the path using SVG -->
        <div class="path-visualization">
          <svg>
            <path
              d="M 100,300 C 200,100 400,500 500,300"
              stroke="#ddd"
              fill="none"
              stroke-width="2"
            />
          </svg>
        </div>

        <!-- Path Elements -->
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="1"
          data-ks-offset="0"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.9"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.8"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.7"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.6"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.5"
          style="background-color: lightblue"
        ></div>
        <div
          class="path-element"
          data-kinesispath-element
          data-ks-strength="0.4"
          style="background-color: lightblue"
        ></div>
      </div>
    </section>

    <div class="demo-section">
      <h3>Simple Audio Effect</h3>
      <div
        class="container"
        id="audio-demo-1"
        data-kinesisaudio
        data-ks-audio="audio.mp3"
        data-ks-playaudio="false"
      >
        <div
          class="audio-element"
          data-kinesisaudio-element
          data-ks-audioindex="60"
          data-ks-strength="20"
          data-ks-type="scale"
        ></div>
        <!-- <div
          class="audio-element"
          data-kinesisaudio-element
          data-ks-audioindex="80"
          data-ks-strength="50"
          data-ks-type="scale"
        ></div>
        <div
          class="audio-element"
          data-kinesisaudio-element
          data-ks-audioindex="100"
          data-ks-strength="50"
          data-ks-type="scale"
        ></div> -->
      </div>
      <div class="control-buttons">
        <button id="play-audio-demo-1">Play Audio</button>
        <button id="stop-audio-demo-1">Stop Audio</button>
      </div>
    </div>

    <div>
      <div data-kinesistransformer class="tilt-container">
        <div data-kinesistransformer-element data-ks-transform="tilt">
          Hello
        </div>
        <div data-kinesistransformer-element data-ks-transform="tilt">
          Hello
        </div>
        <div
          data-kinesistransformer-element
          data-ks-transform="tilt"
          data-ks-strength="50"
        >
          Hello
        </div>
      </div>
    </div>

    <div id="svg-grid-container"></div>

    <script type="module" src="/src/main.ts"></script>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        // Handle Play and Stop buttons for Audio Demo 1
        const playButton1 = document.getElementById("play-audio-demo-1");
        const stopButton1 = document.getElementById("stop-audio-demo-1");
        const container1 = document.getElementById("audio-demo-1");
        const kinesisAudio1 = container1._kinesisAudio;

        if (playButton1 && kinesisAudio1) {
          playButton1.addEventListener("click", () => kinesisAudio1.play());
        }

        if (stopButton1 && kinesisAudio1) {
          stopButton1.addEventListener("click", () => kinesisAudio1.stop());
        }
      });

      /**
       * Function to create an SVG grid with nodes and connecting lines.
       * Each node will have Kinesis distance attributes for animations.
       *
       * @param {number} rows - Number of rows in the grid.
       * @param {number} cols - Number of columns in the grid.
       * @param {number} nodeRadius - Radius of each node.
       * @param {number} horizontalSpacing - Horizontal spacing between nodes.
       * @param {number} verticalSpacing - Vertical spacing between nodes.
       * @param {string} transform - Transformation type ('translate', 'scale', etc.).
       * @param {string} strength - Strength value for Kinesis animations.
       * @param {string} distance - Starting distance value for Kinesis animations.
       */
      // function createDistanceSVGGrid(
      //   rows,
      //   cols,
      //   nodeRadius,
      //   horizontalSpacing,
      //   verticalSpacing,
      //   transform,
      //   strength,
      //   distance
      // ) {
      //   const svgNS = "http://www.w3.org/2000/svg";

      //   // Create SVG Element
      //   const svg = document.createElementNS(svgNS, "svg");
      //   svg.setAttribute("class", "distance-grid-svg");
      //   svg.setAttribute("width", cols * horizontalSpacing + 100); // Extra space for margins
      //   svg.setAttribute("height", rows * verticalSpacing + 100); // Extra space for margins
      //   svg.setAttribute(
      //     "viewBox",
      //     `0 0 ${cols * horizontalSpacing + 100} ${
      //       rows * verticalSpacing + 100
      //     }`
      //   );

      //   // Optional: Add a background rectangle
      //   const bgRect = document.createElementNS(svgNS, "rect");
      //   bgRect.setAttribute("width", "100%");
      //   bgRect.setAttribute("height", "100%");
      //   bgRect.setAttribute("fill", "#ffffff");
      //   svg.appendChild(bgRect);

      //   // Iterate through rows and columns to create nodes and lines
      //   for (let row = 0; row < rows; row++) {
      //     for (let col = 0; col < cols; col++) {
      //       const x = 50 + col * horizontalSpacing; // Starting offset
      //       const y = 50 + row * verticalSpacing; // Starting offset

      //       // Create Node (Circle)
      //       const node = document.createElementNS(svgNS, "circle");
      //       node.setAttribute("class", "distance-item");
      //       node.setAttribute("cx", x);
      //       node.setAttribute("cy", y);
      //       node.setAttribute("r", nodeRadius);
      //       node.setAttribute("data-kinesisdistance-item", "");
      //       node.setAttribute("data-ks-transform", transform);
      //       node.setAttribute("data-ks-strength", strength);
      //       node.setAttribute("data-ks-startdistance", distance);
      //       node.setAttribute("data-ks-velocity", "acceleration"); // Optional: Based on your requirements
      //       node.setAttribute("id", `node-${row}-${col}`); // Assign unique ID

      //       svg.appendChild(node);

      //       // Create Horizontal Line (to the next node in the row)
      //       if (col < cols - 1) {
      //         // Avoid drawing beyond the last column
      //         const line = document.createElementNS(svgNS, "line");
      //         line.setAttribute("class", "distance-line");
      //         line.setAttribute("x1", x + nodeRadius);
      //         line.setAttribute("y1", y);
      //         line.setAttribute("x2", x + horizontalSpacing - nodeRadius);
      //         line.setAttribute("y2", y);
      //         // Assign data attributes to link to nodes
      //         line.setAttribute("data-from", `node-${row}-${col}`);
      //         line.setAttribute("data-to", `node-${row}-${col + 1}`);
      //         svg.appendChild(line);
      //       }

      //       // Create Vertical Line (to the next node in the column)
      //       if (row < rows - 1) {
      //         // Avoid drawing beyond the last row
      //         const line = document.createElementNS(svgNS, "line");
      //         line.setAttribute("class", "distance-line");
      //         line.setAttribute("x1", x);
      //         line.setAttribute("y1", y + nodeRadius);
      //         line.setAttribute("x2", x);
      //         line.setAttribute("y2", y + verticalSpacing - nodeRadius);
      //         // Assign data attributes to link to nodes
      //         line.setAttribute("data-from", `node-${row}-${col}`);
      //         line.setAttribute("data-to", `node-${row + 1}-${col}`);
      //         svg.appendChild(line);
      //       }
      //     }
      //   }

      //   // Append SVG to the Container
      //   const gridContainer = document.getElementById("svg-grid-container");
      //   gridContainer.appendChild(svg);

      //   // Anchor lines to nodes
      //   anchorLinesToNodes(svg);
      // }

      // /**
      //  * Function to anchor lines to their connected nodes.
      //  * It updates the positions of lines based on the current positions of connected nodes.
      //  * @param {SVGElement} svg - The SVG element containing the grid.
      //  */
      // function anchorLinesToNodes(svg) {
      //   // Get all lines
      //   const lines = svg.querySelectorAll(".distance-line");

      //   // Get all nodes
      //   const nodes = svg.querySelectorAll(".distance-item");

      //   // Create a map of node IDs to node elements
      //   const nodeMap = {};
      //   nodes.forEach((node) => {
      //     const id = node.getAttribute("id");
      //     nodeMap[id] = node;
      //   });

      //   /**
      //    * Function to get the transformed position of a node relative to the SVG's coordinate system.
      //    * @param {SVGElement} element - The SVG node element.
      //    * @param {SVGSVGElement} svg - The parent SVG element.
      //    * @returns {Object} - An object with x and y coordinates.
      //    */
      //   function getSVGTransformedPosition(element, svg) {
      //     // Get the bounding box relative to the viewport
      //     const bbox = element.getBoundingClientRect();

      //     // Get the SVG's bounding box relative to the viewport
      //     const svgBBox = svg.getBoundingClientRect();

      //     // Calculate the position relative to the SVG
      //     const x = bbox.left + bbox.width / 2 - svgBBox.left;
      //     const y = bbox.top + bbox.height / 2 - svgBBox.top;

      //     return { x, y };
      //   }

      //   /**
      //    * Function to update all lines based on the current positions of their connected nodes.
      //    */
      //   function updateLines() {
      //     lines.forEach((line) => {
      //       const fromId = line.getAttribute("data-from");
      //       const toId = line.getAttribute("data-to");

      //       const fromNode = nodeMap[fromId];
      //       const toNode = nodeMap[toId];

      //       if (fromNode && toNode) {
      //         // Get transformed positions
      //         const fromPos = getSVGTransformedPosition(fromNode, svg);
      //         const toPos = getSVGTransformedPosition(toNode, svg);

      //         // Update line attributes
      //         line.setAttribute("x1", fromPos.x);
      //         line.setAttribute("y1", fromPos.y);
      //         line.setAttribute("x2", toPos.x);
      //         line.setAttribute("y2", toPos.y);
      //       }
      //     });

      //     // Continue the loop
      //     requestAnimationFrame(updateLines);
      //   }

      //   // Start the update loop
      //   requestAnimationFrame(updateLines);
      // }

      // // Wait for DOM to load before creating the grid and initializing Kinesis.js
      // document.addEventListener("DOMContentLoaded", () => {
      //   // Parameters for the grid
      //   const rows = 10;
      //   const cols = 10;
      //   const nodeRadius = 5;
      //   const horizontalSpacing = 100; // Adjust as needed
      //   const verticalSpacing = 100; // Adjust as needed

      //   // Create the SVG Grid with 'translate' transformation
      //   createDistanceSVGGrid(
      //     rows,
      //     cols,
      //     nodeRadius,
      //     horizontalSpacing,
      //     verticalSpacing,
      //     "translate",
      //     "-80",
      //     "200"
      //   );

      //   // Initialize Kinesis after the grid has been added to the DOM
      //   Kinesis.init();
      //   console.log("Kinesis.js has been initialized");
      // });

      /**
       * Creates an SVG grid with nodes and connecting lines.
       * @param {number} rows - Number of rows.
       * @param {number} cols - Number of columns.
       * @param {number} radius - Radius of each node.
       * @param {number} spacingX - Horizontal spacing.
       * @param {number} spacingY - Vertical spacing.
       * @param {string} transform - Transformation type for Kinesis.
       * @param {string} strength - Strength value for Kinesis.
       * @param {string} distance - Starting distance for Kinesis.
       */
      function createSVGGrid(
        rows,
        cols,
        radius,
        spacingX,
        spacingY,
        transform,
        strength,
        distance
      ) {
        const svgNS = "http://www.w3.org/2000/svg";
        const svg = document.createElementNS(svgNS, "svg");
        svg.classList.add("distance-grid-svg");
        svg.setAttribute("width", cols * spacingX + 100);
        svg.setAttribute("height", rows * spacingY + 100);
        svg.setAttribute(
          "viewBox",
          `0 0 ${cols * spacingX + 100} ${rows * spacingY + 100}`
        );

        // Optional: Background Rectangle
        const bg = document.createElementNS(svgNS, "rect");
        bg.setAttribute("width", "100%");
        bg.setAttribute("height", "100%");
        bg.setAttribute("fill", "#ffffff");
        svg.appendChild(bg);

        // Store node references
        const nodeMap = {};

        // Create Nodes
        for (let r = 0; r < rows; r++) {
          for (let c = 0; c < cols; c++) {
            const x = 50 + c * spacingX;
            const y = 50 + r * spacingY;
            const node = document.createElementNS(svgNS, "circle");
            node.classList.add("distance-item");
            node.setAttribute("cx", x);
            node.setAttribute("cy", y);
            node.setAttribute("r", radius);
            node.setAttribute("id", `node-${r}-${c}`);
            node.setAttribute("data-kinesisdistance-item", "");
            node.setAttribute("data-ks-transform", transform);
            node.setAttribute("data-ks-strength", strength);
            node.setAttribute("data-ks-startdistance", distance);
            node.setAttribute("data-ks-velocity", "acceleration");
            svg.appendChild(node);
            nodeMap[node.id] = node;

            // Connect to the right neighbor
            if (c < cols - 1) {
              const line = document.createElementNS(svgNS, "line");
              line.classList.add("distance-line");
              line.setAttribute("data-from", node.id);
              line.setAttribute("data-to", `node-${r}-${c + 1}`);
              svg.appendChild(line);
            }

            // Connect to the bottom neighbor
            if (r < rows - 1) {
              const line = document.createElementNS(svgNS, "line");
              line.classList.add("distance-line");
              line.setAttribute("data-from", node.id);
              line.setAttribute("data-to", `node-${r + 1}-${c}`);
              svg.appendChild(line);
            }
          }
        }

        document.getElementById("svg-grid-container").appendChild(svg);
        return { svg, nodeMap };
      }

      /**
       * Updates line positions based on connected nodes.
       * @param {SVGElement} svg - The SVG element containing the grid.
       * @param {Object} nodeMap - Map of node IDs to node elements.
       */
      function anchorLines(svg, nodeMap) {
        const lines = svg.querySelectorAll(".distance-line");

        function update() {
          lines.forEach((line) => {
            const from = nodeMap[line.getAttribute("data-from")];
            const to = nodeMap[line.getAttribute("data-to")];
            if (from && to) {
              line.setAttribute("x1", from.getAttribute("cx"));
              line.setAttribute("y1", from.getAttribute("cy"));
              line.setAttribute("x2", to.getAttribute("cx"));
              line.setAttribute("y2", to.getAttribute("cy"));
            }
          });
          requestAnimationFrame(update);
        }

        requestAnimationFrame(update);
      }

      // Initialize the Grid and Kinesis.js on DOM Content Loaded
      document.addEventListener("DOMContentLoaded", () => {
        const { svg, nodeMap } = createSVGGrid(
          10,
          10,
          5,
          100,
          100,
          "translate",
          "-80",
          "200"
        );
        anchorLines(svg, nodeMap);
        Kinesis.init();
        console.log("Kinesis.js has been initialized");
      });
    </script>
  </body>
</html>
